<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <meta name="description" content="Ton assistant cuisine personnel - GÃ¨re ton inventaire et dÃ©couvre quelles recettes tu peux cuisiner">
  <meta name="theme-color" content="#e8a87c">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="Cooking Dada">
  
  <link rel="manifest" href="./manifest.json">
  <link rel="icon" type="image/png" sizes="192x192" href="./icons/icon-192.png">
  <link rel="apple-touch-icon" href="./icons/icon-192.png">
  <link rel="stylesheet" href="./style.css">
  
  <script type="module" src="./dist/main.js"></script>
  <script>
    if ("serviceWorker" in navigator) {
      navigator.serviceWorker.register("./sw.js")
        .then(() => console.log("Service Worker registered"))
        .catch((err) => console.error("Service Worker registration failed:", err));
    }
  </script>
  <title>Cooking Dada</title>
</head>
<body>
  <header>
    <div class="chef-hat">ğŸ‘¨â€ğŸ³</div>
    <h1>Cooking Dada</h1>
    <p class="subtitle">extase et gourmandise</p>
  </header>

  <main>
    <!-- Action Bar -->
    <div class="action-bar">
      <button id="stockUpdate" class="btn btn-primary">
        + Ajouter au stock
      </button>
      <button id="addRecipe" class="btn btn-secondary">
        + Nouvelle recette
      </button>
      <button id="importRecipe" class="btn btn-import">
        ğŸŒ Importer
      </button>
      <button id="openGroceryList" class="btn btn-grocery">
        ğŸ›’ Liste de courses
      </button>
    </div>

    <!-- Recipes Section -->
    <section class="recipes-section">
      <h2 class="section-title">Mes Recettes</h2>
      
      <!-- Search and Filter Bar -->
      <div class="recipe-filters">
        <input type="text" id="recipeSearch" placeholder="Rechercher une recette..." class="search-input">
        <div class="filter-buttons">
          <button class="filter-btn active" data-filter="all">Toutes</button>
          <button class="filter-btn" data-filter="available">PrÃªtes</button>
          <button class="filter-btn" data-filter="unavailable">Manquantes</button>
        </div>
        <select id="tagFilter" class="tag-filter-select">
          <option value="">Tous les tags</option>
          <!-- Tags will be populated dynamically -->
        </select>
      </div>
      
      <div id="recipesContainer">
        <!-- Recipe cards will be inserted here -->
      </div>
    </section>

    <!-- Stocks Section -->
    <section class="stocks-section">
      <h2>ğŸ“¦ Mon Inventaire</h2>
      <div id="stocksInfosContainer">
        <!-- Stock items will be inserted here -->
      </div>
    </section>
  </main>

  <!-- Stock Dialog -->
  <dialog id="stockDialog">
    <div class="dialog-header">
      <h2>Ajouter au stock</h2>
    </div>
    <div class="dialog-body">
      <p class="dialog-intro">Ajoute des ingrÃ©dients Ã  ton inventaire. Les quantitÃ©s seront ajoutÃ©es aux stocks existants.</p>
      
      <div id="stock-rows">
        <!-- Stock rows will be inserted here -->
      </div>
      
      <button type="button" id="addRowBtn" class="btn btn-add-row">+ Ajouter une ligne</button>
      
      <div class="form-actions">
        <button type="button" id="cancelStock" class="btn btn-ghost">Annuler</button>
        <button type="button" id="submitStocks" class="btn btn-primary">Enregistrer tout</button>
      </div>
      
      <datalist id="ingredients-list"></datalist>
    </div>
  </dialog>

  <!-- Recipe Dialog -->
  <dialog id="recipeDialog">
    <div class="dialog-header">
      <h2 id="recipe-dialog-title">Nouvelle recette</h2>
    </div>
    <div class="dialog-body">
      <div class="form-group">
        <label for="recipe-name">Nom de la recette</label>
        <input 
          type="text" 
          id="recipe-name" 
          placeholder="Ex: Risotto aux champignons..."
          required
        />
      </div>
      
      <div class="form-group">
        <label for="recipe-people">Nombre de personnes</label>
        <input 
          type="number" 
          id="recipe-people" 
          min="1" 
          value="4"
          required
        />
      </div>
      
      <div class="form-group">
        <label>IngrÃ©dients</label>
        <div id="recipe-ingredient-rows">
          <!-- Ingredient rows will be inserted here -->
        </div>
        <button type="button" id="addRecipeIngredientBtn" class="btn btn-add-row">+ Ajouter un ingrÃ©dient</button>
      </div>
      
      <div class="form-group">
        <label>Tags</label>
        <div class="tag-selector">
          <div class="preset-tags">
            <button type="button" class="tag-chip" data-tag="rapide">rapide</button>
            <button type="button" class="tag-chip" data-tag="vÃ©gÃ©tarien">vÃ©gÃ©tarien</button>
            <button type="button" class="tag-chip" data-tag="dessert">dessert</button>
            <button type="button" class="tag-chip" data-tag="Ã©tÃ©">Ã©tÃ©</button>
            <button type="button" class="tag-chip" data-tag="hiver">hiver</button>
            <button type="button" class="tag-chip" data-tag="Ã©conomique">Ã©conomique</button>
          </div>
          <div class="custom-tag-input">
            <input type="text" id="custom-tag" placeholder="Ajouter un tag personnalisÃ©...">
            <button type="button" id="addCustomTag" class="btn-add-tag">+</button>
          </div>
          <div id="selected-tags" class="selected-tags">
            <!-- Selected tags will appear here -->
          </div>
        </div>
      </div>
      
      <div class="form-actions">
        <button type="button" id="cancelRecipe" class="btn btn-ghost">Annuler</button>
        <button type="button" id="submitRecipe" class="btn btn-primary">Enregistrer</button>
      </div>
    </div>
  </dialog>

  <!-- Grocery List Dialog -->
  <dialog id="groceryDialog">
    <div class="dialog-header">
      <h2>ğŸ›’ Liste de courses</h2>
    </div>
    <div class="dialog-body">
      <div id="grocery-items">
        <!-- Grocery items will be inserted here -->
      </div>
      <div class="form-actions grocery-actions">
        <button type="button" id="clearGroceryList" class="btn btn-ghost">Vider la liste</button>
        <button type="button" id="finishShopping" class="btn btn-primary">Courses faites !</button>
      </div>
      <button type="button" id="closeGroceryList" class="btn-close-grocery">âœ•</button>
    </div>
  </dialog>

  <!-- Import Recipe Dialog -->
  <dialog id="importDialog">
    <div class="dialog-header">
      <h2>ğŸŒ Importer une recette</h2>
    </div>
    <div class="dialog-body">
      <p class="dialog-intro">
        Colle l'URL d'une recette depuis Marmiton, Jow, 750g, ou d'autres sites.
      </p>
      <div class="form-group">
        <label for="import-url">URL de la recette</label>
        <input 
          type="url" 
          id="import-url" 
          placeholder="https://www.marmiton.org/recettes/..."
          required
        />
      </div>
      <div id="import-status" class="import-status"></div>
      <div class="form-actions">
        <button type="button" id="cancelImport" class="btn btn-ghost">Annuler</button>
        <button type="button" id="submitImport" class="btn btn-primary">
          <span class="import-btn-text">Importer</span>
          <span class="import-btn-loading" hidden>Chargement...</span>
        </button>
      </div>
    </div>
  </dialog>
</body>
</html>
